<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/feedback.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/index.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/popup.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/aboutUs.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/overdoseTable.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/overdoseFormPopup.css">
    <script type="text/javascript" src="/jquery-ui-theme/external/jquery/jquery.js"></script>
      	<script type="text/javascript" src="/jquery-ui-theme/jquery-ui.min.js"></script>
    <link href="https://unpkg.com/tabulator-tables@4.0.5/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.0.5/dist/js/tabulator.min.js"></script>
</head>
<body>
    <span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776;</span>
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="/home">Homepage</a>
        <a href="/drugname">Drug Name</a>
        <a href="/StateVsDeath">State vs Opioid Deaths</a>
        <a href="/StateVsPop">State vs Population</a>
        <a href="/heatmap">HeatMap</a>
        <a href="/feedback">Feedback</a>
        <a href="/aboutUs">About Us</a>
        <a href="/overdose">Overdoses</a>
    </div>

<button style="float:right" onclick="openForm()">Open Form</button>

<div class="form-popup" id="myForm">
  <form action="/action_page.php" class="form-container">
    <h1>Add/ Update</h1>

    <label for="state"><b>State</b></label>
    <input type="text" placeholder="Enter State Name" name="state" required>

    <label for="pop"><b>Population</b></label>
    <input type="text" placeholder="Enter Population of state" name="pop" required>
    
    <label for="death"><b>Deaths</b></label>
    <input type="text" placeholder="Enter no. of deaths caused by opm overdose" name="death" required>
    
    <label for="abbr"><b>State Abbreviation</b></label>
    <input type="text" placeholder="Enter Abbreviation for state" name="abbr" required>

    <button type="submit" class="btn">Update/Add Record</button>
    <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
  </form>
</div>

<table id="DrugOverdoseTable">
        <thead>
          <tr>
            <th>State</th>
            <th>Population</th>
            <th>Deaths</th>
            <th>Abbrev</th>
            <th>Delete</th>
            
  
          </tr>
        </thead>
  
        <tbody>
          <% for(var i=0; i < data.length; i++) { %>
         <tr>
  
           <td><%= data[i].State %></td>
           <td><%= data[i].Population %></td>
           <td><%= data[i].Deaths %></td>
           <td><%= data[i].Abbrev %></td> 
           <td> <button id = <%= data[i].id %> onclick = "passID(this.id)"> Delete </button></td>
  
         </tr>
      <% } %>
        </tbody>
  
      </table>

<script>
  function passID(clickedID) {
   // alert(clickedID);
    var settings = {
      "async": true,
      "crossDomain": true,
      "url": "http://localhost:3000/"+clickedID+"/delete",
      "method": "DELETE",
      "headers": {
        "Cache-Control": "no-cache"
      }
    }

    $.ajax(settings).done(function (response) {
      alert(response);
      document.location.reload();
    });
  }
</script>

<script>
  function openForm() {
      document.getElementById("myForm").style.display = "block";
  }
  
  function closeForm() {
      document.getElementById("myForm").style.display = "none";
  }
  </script>

<div id="table"></div>
</body>
<script type="text/javascript" src="/routes/nav.js"></script>
</html>